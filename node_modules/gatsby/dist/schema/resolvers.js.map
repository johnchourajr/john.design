{"version":3,"sources":["../../src/schema/resolvers.ts"],"names":["findMany","typeName","findManyResolver","_source","args","context","info","stats","totalRunQuery","totalPluralRunQuery","nodeModel","runQuery","query","firstOnly","type","schema","getType","tracer","path","connectionType","findOne","findOneResolver","filter","findManyPaginated","findManyPaginatedResolver","source","group","getProjectedField","distinct","extendedArgs","result","paginate","skip","limit","distinctResolver","field","edges","values","reduce","acc","node","value","concat","Date","toISOString","Array","from","Set","sort","groupResolver","groupedResults","isArray","forEach","key","Object","create","keys","fieldValue","push","results","count","length","items","slice","pageCount","Math","ceil","currentPage","hasPreviousPage","hasNextPage","NaN","totalCount","map","item","i","arr","next","previous","nodes","pageInfo","itemCount","perPage","link","options","by","fieldConfig","linkResolver","resolver","resolve","defaultFieldResolver","fieldValueOrPromise","fromNode","then","linkResolverValue","returnType","getNodesByIds","ids","getNodeById","id","runQueryArgs","split","reduceRight","obj","in","eq","GraphQLList","resultOrPromise","linkResolverQueryResult","queryResult","find","fileByPath","fileByPathResolver","parentFileNode","findRootNodeAncestor","internal","findLinkedFileNode","relativePath","fileLinkPath","systemPath","dir","linkedFileNode","_","getAllNodes","n","absolutePath","resolveValue","v","fieldName","selectionSet","fieldNodes","getFieldNodeByNameInSelectionSet","getFields","fieldArg","arg","name","fieldEnum","fieldNode","arguments","kind","Kind","ENUM","enumKey","enumValue","getValue","selections","selection","FRAGMENT_SPREAD","fragmentDef","fragments","INLINE_FRAGMENT","property","WARNED_ABOUT_RESOLVERS","badResolverInvocationMessage","missingVar","resolverName","wrappingResolver","wrappedTracingResolver","parent","reporter","warn","activity","createResolverActivity","parentType","start","end","defaultResolver"],"mappings":"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","sourcesContent":["import systemPath from \"path\"\nimport normalize from \"normalize-path\"\nimport _ from \"lodash\"\nimport {\n  GraphQLList,\n  GraphQLType,\n  getNullableType,\n  getNamedType,\n  Kind,\n  GraphQLFieldConfig,\n  GraphQLResolveInfo,\n  isObjectType,\n  isInterfaceType,\n  isEnumType,\n  SelectionSetNode,\n  SelectionNode,\n  FieldNode,\n} from \"graphql\"\nimport { Path } from \"graphql/jsutils/Path\"\nimport reporter from \"gatsby-cli/lib/reporter\"\nimport { pathToArray } from \"../query/utils\"\nimport { getValueAt } from \"../utils/get-value-at\"\nimport {\n  GatsbyResolver,\n  IGatsbyConnection,\n  IGatsbyResolverContext,\n} from \"./type-definitions\"\nimport { IGatsbyNode } from \"../redux/types\"\n\ntype ResolvedLink = IGatsbyNode | Array<IGatsbyNode> | null\n\nexport function findMany<TSource, TArgs>(\n  typeName: string\n): GatsbyResolver<TSource, TArgs> {\n  return function findManyResolver(_source, args, context, info): any {\n    if (context.stats) {\n      context.stats.totalRunQuery++\n      context.stats.totalPluralRunQuery++\n    }\n\n    return context.nodeModel.runQuery(\n      {\n        query: args,\n        firstOnly: false,\n        type: info.schema.getType(typeName),\n        stats: context.stats,\n        tracer: context.tracer,\n      },\n      { path: context.path, connectionType: typeName }\n    )\n  }\n}\n\nexport function findOne<TSource, TArgs>(\n  typeName: string\n): GatsbyResolver<TSource, TArgs> {\n  return function findOneResolver(_source, args, context, info): any {\n    if (context.stats) {\n      context.stats.totalRunQuery++\n    }\n    return context.nodeModel.runQuery(\n      {\n        query: { filter: args },\n        firstOnly: true,\n        type: info.schema.getType(typeName),\n        stats: context.stats,\n        tracer: context.tracer,\n      },\n      { path: context.path }\n    )\n  }\n}\n\ntype PaginatedArgs<TArgs> = TArgs & { skip?: number; limit?: number }\n\nexport function findManyPaginated<TSource, TArgs, TNodeType>(\n  typeName: string\n): GatsbyResolver<TSource, PaginatedArgs<TArgs>> {\n  return async function findManyPaginatedResolver(\n    source,\n    args,\n    context,\n    info\n  ): Promise<IGatsbyConnection<TNodeType>> {\n    // Peek into selection set and pass on the `field` arg of `group` and\n    // `distinct` which might need to be resolved.\n    const group = getProjectedField(info, `group`)\n    const distinct = getProjectedField(info, `distinct`)\n    const extendedArgs = {\n      ...args,\n      group: group || [],\n      distinct: distinct || [],\n    }\n\n    const result = await findMany<TSource, PaginatedArgs<TArgs>>(typeName)(\n      source,\n      extendedArgs,\n      context,\n      info\n    )\n    return paginate(result, { skip: args.skip, limit: args.limit })\n  }\n}\n\ninterface IFieldConnectionArgs {\n  field: string\n}\n\nexport const distinct: GatsbyResolver<\n  IGatsbyConnection<any>,\n  IFieldConnectionArgs\n> = function distinctResolver(source, args): Array<string> {\n  const { field } = args\n  const { edges } = source\n  const values = edges.reduce((acc, { node }) => {\n    const value =\n      getValueAt(node, `__gatsby_resolved.${field}`) || getValueAt(node, field)\n    return value != null\n      ? acc.concat(value instanceof Date ? value.toISOString() : value)\n      : acc\n  }, [])\n  return Array.from(new Set(values)).sort()\n}\n\ntype IGatsbyGroupReturnValue<NodeType> = Array<\n  IGatsbyConnection<NodeType> & {\n    field: string\n    fieldValue: string | undefined\n  }\n>\n\nexport const group: GatsbyResolver<\n  IGatsbyConnection<any>,\n  PaginatedArgs<IFieldConnectionArgs>\n> = function groupResolver(source, args): IGatsbyGroupReturnValue<any> {\n  const { field } = args\n  const { edges } = source\n  const groupedResults: Record<string, Array<string>> = edges.reduce(\n    (acc, { node }) => {\n      const value =\n        getValueAt(node, `__gatsby_resolved.${field}`) ||\n        getValueAt(node, field)\n      const values = Array.isArray(value) ? value : [value]\n      values\n        .filter(value => value != null)\n        .forEach(value => {\n          const key = value instanceof Date ? value.toISOString() : value\n          acc[key] = (acc[key] || []).concat(node)\n        })\n      return acc\n      // Note: using Object.create on purpose:\n      //   object key may be arbitrary string including reserved words (i.e. `constructor`)\n      //   see: https://github.com/gatsbyjs/gatsby/issues/22508\n    },\n    Object.create(null)\n  )\n\n  return Object.keys(groupedResults)\n    .sort()\n    .reduce((acc: IGatsbyGroupReturnValue<any>, fieldValue: string) => {\n      acc.push({\n        ...paginate(groupedResults[fieldValue], args),\n        field,\n        fieldValue,\n      })\n      return acc\n    }, [])\n}\n\nexport function paginate<NodeType>(\n  results: Array<NodeType> = [],\n  { skip = 0, limit }: { skip?: number; limit?: number }\n): IGatsbyConnection<NodeType> {\n  if (results === null) {\n    results = []\n  }\n\n  const count = results.length\n  const items = results.slice(skip, limit && skip + limit)\n\n  const pageCount = limit\n    ? Math.ceil(skip / limit) + Math.ceil((count - skip) / limit)\n    : skip\n    ? 2\n    : 1\n  const currentPage = limit ? Math.ceil(skip / limit) + 1 : skip ? 2 : 1\n  const hasPreviousPage = currentPage > 1\n  const hasNextPage = skip + (limit || NaN) < count\n\n  return {\n    totalCount: count,\n    edges: items.map((item, i, arr) => {\n      return {\n        node: item,\n        next: arr[i + 1],\n        previous: arr[i - 1],\n      }\n    }),\n    nodes: items,\n    pageInfo: {\n      currentPage,\n      hasPreviousPage,\n      hasNextPage,\n      itemCount: items.length,\n      pageCount,\n      perPage: limit,\n      totalCount: count,\n    },\n  }\n}\n\nexport function link<TSource, TArgs>(\n  options: {\n    by: string\n    type?: GraphQLType\n    from?: string\n    fromNode?: string\n  } = {\n    by: `id`,\n  },\n  fieldConfig: GraphQLFieldConfig<\n    TSource,\n    IGatsbyResolverContext<TSource, TArgs>,\n    TArgs\n  >\n): GatsbyResolver<TSource, TArgs> {\n  // Note: we explicitly make an attempt to prevent using the `async` keyword because often\n  //       it does not return a promise and this makes a significant difference at scale.\n\n  return function linkResolver(\n    source,\n    args,\n    context,\n    info\n  ): ResolvedLink | Promise<ResolvedLink> {\n    const resolver = fieldConfig.resolve || context.defaultFieldResolver\n    const fieldValueOrPromise = resolver(source, args, context, {\n      ...info,\n      from: options.from || info.from,\n      fromNode: options.from ? options.fromNode : info.fromNode,\n    })\n\n    // Note: for this function, at scale, conditional .then is more efficient than generic await\n    if (typeof fieldValueOrPromise?.then === `function`) {\n      return fieldValueOrPromise.then(fieldValue =>\n        linkResolverValue(fieldValue, args, context, info)\n      )\n    }\n\n    return linkResolverValue(fieldValueOrPromise, args, context, info)\n  }\n\n  function linkResolverValue(\n    fieldValue,\n    args,\n    context,\n    info\n  ): ResolvedLink | Promise<ResolvedLink> {\n    if (fieldValue == null) {\n      return null\n    }\n\n    const returnType = getNullableType(options.type || info.returnType)\n    const type = getNamedType(returnType)\n\n    if (options.by === `id`) {\n      if (Array.isArray(fieldValue)) {\n        return context.nodeModel.getNodesByIds(\n          { ids: fieldValue, type: type },\n          { path: context.path }\n        )\n      } else {\n        return context.nodeModel.getNodeById(\n          { id: fieldValue, type: type },\n          { path: context.path }\n        )\n      }\n    }\n\n    // Return early if fieldValue is [] since { in: [] } doesn't make sense\n    if (Array.isArray(fieldValue) && fieldValue.length === 0) {\n      return fieldValue\n    }\n\n    const runQueryArgs = args as TArgs & { filter: Record<string, any> }\n    runQueryArgs.filter = options.by.split(`.`).reduceRight(\n      (acc: Record<string, any>, key: string) => {\n        const obj = {}\n        obj[key] = acc\n        return obj\n      },\n      Array.isArray(fieldValue) ? { in: fieldValue } : { eq: fieldValue }\n    )\n\n    const firstOnly = !(returnType instanceof GraphQLList)\n\n    if (context.stats) {\n      context.stats.totalRunQuery++\n      if (firstOnly) {\n        context.stats.totalPluralRunQuery++\n      }\n    }\n\n    const resultOrPromise = context.nodeModel.runQuery(\n      {\n        query: runQueryArgs,\n        firstOnly,\n        type,\n        stats: context.stats,\n        tracer: context.tracer,\n      },\n      { path: context.path }\n    )\n\n    // Note: for this function, at scale, conditional .then is more efficient than generic await\n    if (typeof resultOrPromise?.then === `function`) {\n      return resultOrPromise.then(result =>\n        linkResolverQueryResult(fieldValue, result, returnType)\n      )\n    }\n\n    return linkResolverQueryResult(fieldValue, resultOrPromise, returnType)\n  }\n\n  function linkResolverQueryResult(\n    fieldValue,\n    queryResult,\n    returnType\n  ): IGatsbyNode | Array<IGatsbyNode> {\n    if (\n      returnType instanceof GraphQLList &&\n      Array.isArray(fieldValue) &&\n      Array.isArray(queryResult)\n    ) {\n      return fieldValue.map(value =>\n        queryResult.find(obj => getValueAt(obj, options.by) === value)\n      )\n    } else {\n      return queryResult\n    }\n  }\n}\n\nexport function fileByPath<TSource, TArgs>(\n  options: {\n    from?: string\n    fromNode?: string\n  } = {},\n  fieldConfig\n): GatsbyResolver<TSource, TArgs> {\n  return async function fileByPathResolver(\n    source,\n    args,\n    context,\n    info\n  ): Promise<any> {\n    const resolver = fieldConfig.resolve || context.defaultFieldResolver\n    const fieldValue = await resolver(source, args, context, {\n      ...info,\n      from: options.from || info.from,\n      fromNode: options.from ? options.fromNode : info.fromNode,\n    })\n\n    if (fieldValue == null) return null\n\n    // Find the File node for this node (we assume the node is something\n    // like markdown which would be a child node of a File node).\n    const parentFileNode = context.nodeModel.findRootNodeAncestor(\n      source,\n      node => node.internal && node.internal.type === `File`\n    )\n\n    const findLinkedFileNode = (relativePath: string): any => {\n      // Use the parent File node to create the absolute path to\n      // the linked file.\n      const fileLinkPath = normalize(\n        systemPath.resolve(parentFileNode.dir, relativePath)\n      )\n\n      // Use that path to find the linked File node.\n      const linkedFileNode = _.find(\n        context.nodeModel.getAllNodes({ type: `File` }),\n        n => n.absolutePath === fileLinkPath\n      )\n      return linkedFileNode\n    }\n\n    return resolveValue(findLinkedFileNode, fieldValue)\n  }\n}\n\nfunction resolveValue(\n  resolve: (a: any) => any,\n  value: any | Array<any>\n): any | Array<any> {\n  return Array.isArray(value)\n    ? value.map(v => resolveValue(resolve, v))\n    : resolve(value)\n}\n\nfunction getProjectedField(\n  info: GraphQLResolveInfo,\n  fieldName: string\n): Array<string> {\n  const selectionSet = info.fieldNodes[0].selectionSet\n  if (selectionSet) {\n    const fieldNodes = getFieldNodeByNameInSelectionSet(\n      selectionSet,\n      fieldName,\n      info\n    )\n\n    const returnType = getNullableType(info.returnType)\n\n    if (isObjectType(returnType) || isInterfaceType(returnType)) {\n      const field = returnType.getFields()[fieldName]\n      const fieldArg = field?.args?.find(arg => arg.name === `field`)\n      if (fieldArg) {\n        const fieldEnum = getNullableType(fieldArg.type)\n\n        if (isEnumType(fieldEnum)) {\n          return fieldNodes.reduce(\n            (acc: Array<string>, fieldNode: FieldNode) => {\n              const fieldArg = fieldNode.arguments?.find(\n                arg => arg.name.value === `field`\n              )\n              if (fieldArg?.value.kind === Kind.ENUM) {\n                const enumKey = fieldArg.value.value\n                const enumValue = fieldEnum.getValue(enumKey)\n                if (enumValue) {\n                  return [...acc, enumValue.value]\n                }\n              }\n              return acc\n            },\n            []\n          )\n        }\n      }\n    }\n  }\n\n  return []\n}\n\nfunction getFieldNodeByNameInSelectionSet(\n  selectionSet: SelectionSetNode,\n  fieldName: string,\n  info: GraphQLResolveInfo\n): Array<FieldNode> {\n  return selectionSet.selections.reduce(\n    (acc: Array<FieldNode>, selection: SelectionNode) => {\n      if (selection.kind === Kind.FRAGMENT_SPREAD) {\n        const fragmentDef = info.fragments[selection.name.value]\n        if (fragmentDef) {\n          return [\n            ...acc,\n            ...getFieldNodeByNameInSelectionSet(\n              fragmentDef.selectionSet,\n              fieldName,\n              info\n            ),\n          ]\n        }\n      } else if (selection.kind === Kind.INLINE_FRAGMENT) {\n        return [\n          ...acc,\n          ...getFieldNodeByNameInSelectionSet(\n            selection.selectionSet,\n            fieldName,\n            info\n          ),\n        ]\n      } /* FIELD_NODE */ else {\n        if (selection.name.value === fieldName) {\n          return [...acc, selection]\n        }\n      }\n      return acc\n    },\n    []\n  )\n}\n\nexport const defaultFieldResolver: GatsbyResolver<\n  any,\n  any\n> = function defaultFieldResolver(source, args, context, info) {\n  if (\n    (typeof source == `object` && source !== null) ||\n    typeof source === `function`\n  ) {\n    if (info.from) {\n      if (info.fromNode) {\n        const node = context.nodeModel.findRootNodeAncestor(source)\n        if (!node) return null\n        return getValueAt(node, info.from)\n      }\n      return getValueAt(source, info.from)\n    }\n    const property = source[info.fieldName]\n    if (typeof property === `function`) {\n      return source[info.fieldName](args, context, info)\n    }\n    return property\n  }\n\n  return null\n}\n\nlet WARNED_ABOUT_RESOLVERS = false\nfunction badResolverInvocationMessage(missingVar: string, path?: Path): string {\n  const resolverName = path ? `${pathToArray(path)} ` : ``\n  return `GraphQL Resolver ${resolverName}got called without \"${missingVar}\" argument. This might cause unexpected errors.\n\nIt's likely that this has happened in a schemaCustomization with manually invoked resolver. If manually invoking resolvers, it's best to invoke them as follows:\n\n  resolve(parent, args, context, info)\n\n`\n}\n\nexport function wrappingResolver<TSource, TArgs>(\n  resolver: GatsbyResolver<TSource, TArgs>\n): GatsbyResolver<TSource, TArgs> {\n  // Note: we explicitly make an attempt to prevent using the `async` keyword because often\n  //       it does not return a promise and this makes a significant difference at scale.\n  //       GraphQL will gracefully handle the resolver result of a promise or non-promise.\n\n  return function wrappedTracingResolver(\n    parent,\n    args,\n    context,\n    info\n  ): Promise<any> {\n    if (!WARNED_ABOUT_RESOLVERS) {\n      if (!info) {\n        reporter.warn(badResolverInvocationMessage(`info`))\n        WARNED_ABOUT_RESOLVERS = true\n      } else if (!context) {\n        reporter.warn(badResolverInvocationMessage(`context`, info.path))\n        WARNED_ABOUT_RESOLVERS = true\n      }\n    }\n\n    let activity\n    if (context?.tracer) {\n      activity = context.tracer.createResolverActivity(\n        info.path,\n        `${info.parentType.name}.${info.fieldName}`\n      )\n      activity.start()\n    }\n    try {\n      return resolver(parent, args, context, info)\n    } finally {\n      if (activity) {\n        activity.end()\n      }\n    }\n  }\n}\n\nexport const defaultResolver = wrappingResolver(defaultFieldResolver)\n"],"file":"resolvers.js"}