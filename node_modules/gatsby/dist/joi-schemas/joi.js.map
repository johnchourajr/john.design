{"version":3,"sources":["../../src/joi-schemas/joi.ts"],"names":["stripTrailingSlash","chain","replace","addLeadingSlash","when","Joi","string","uri","relativeOnly","then","gatsbyConfigSchema","object","keys","__experimentalThemes","array","flags","polyfill","boolean","default","assetPrefix","allowRelative","pathPrefix","allow","linkPrefix","forbidden","error","Error","siteMetadata","siteUrl","unknown","mapping","plugins","proxy","items","prefix","required","url","single","developMiddleware","func","pageSchema","path","matchPath","component","componentChunkName","context","pluginCreator___NODE","pluginCreatorId","nodeSchema","id","children","parent","fields","internal","contentDigest","mediaType","type","owner","fieldOwners","content","description","ignoreType","counter","number"],"mappings":"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","sourcesContent":["import Joi from \"@hapi/joi\"\nimport { IGatsbyConfig, IGatsbyPage, IGatsbyNode } from \"../redux/types\"\n\nconst stripTrailingSlash = (chain: Joi.StringSchema): Joi.StringSchema =>\n  chain.replace(/(\\w)\\/+$/, `$1`)\n\n// only add leading slash on relative urls\nconst addLeadingSlash = (chain: Joi.StringSchema): Joi.StringSchema =>\n  chain.when(Joi.string().uri({ relativeOnly: true }), {\n    then: chain.replace(/^([^/])/, `/$1`),\n  })\n\nexport const gatsbyConfigSchema: Joi.ObjectSchema<IGatsbyConfig> = Joi.object()\n  .keys({\n    __experimentalThemes: Joi.array(),\n    flags: Joi.object(),\n    polyfill: Joi.boolean().default(true),\n    assetPrefix: stripTrailingSlash(\n      Joi.string().uri({\n        allowRelative: true,\n      })\n    ),\n    pathPrefix: addLeadingSlash(\n      stripTrailingSlash(\n        Joi.string()\n          .uri({\n            allowRelative: true,\n            relativeOnly: true,\n          })\n          .default(``)\n          // removes single / value\n          .allow(``)\n          .replace(/^\\/$/, ``)\n      )\n    ),\n    linkPrefix: Joi.forbidden().error(\n      new Error(`\"linkPrefix\" should be changed to \"pathPrefix\"`)\n    ),\n    siteMetadata: Joi.object({\n      siteUrl: stripTrailingSlash(Joi.string()).uri(),\n    }).unknown(),\n    mapping: Joi.object(),\n    plugins: Joi.array(),\n    proxy: Joi.array()\n      .items(\n        Joi.object().keys({\n          prefix: Joi.string().required(),\n          url: Joi.string().required(),\n        })\n      )\n      .single(),\n    developMiddleware: Joi.func(),\n  })\n  // throws when both assetPrefix and pathPrefix are defined\n  .when(\n    Joi.object({\n      assetPrefix: Joi.string().uri({\n        allowRelative: true,\n        relativeOnly: true,\n      }),\n      pathPrefix: Joi.string()\n        .uri({\n          allowRelative: true,\n          relativeOnly: true,\n        })\n        .default(``),\n    }),\n    {\n      then: Joi.object({\n        assetPrefix: Joi.string()\n          .uri({\n            allowRelative: false,\n          })\n          .error(\n            new Error(\n              `assetPrefix must be an absolute URI when used with pathPrefix`\n            )\n          ),\n      }),\n    }\n  )\n\nexport const pageSchema: Joi.ObjectSchema<IGatsbyPage> = Joi.object()\n  .keys({\n    path: Joi.string().required(),\n    matchPath: Joi.string(),\n    component: Joi.string().required(),\n    componentChunkName: Joi.string().required(),\n    context: Joi.object(),\n    pluginCreator___NODE: Joi.string(),\n    pluginCreatorId: Joi.string(),\n  })\n  .unknown()\n\nexport const nodeSchema: Joi.ObjectSchema<IGatsbyNode> = Joi.object()\n  .keys({\n    id: Joi.string().required(),\n    children: Joi.array().items(Joi.string(), Joi.object().forbidden()),\n    parent: Joi.string().allow(null),\n    fields: Joi.object(),\n    internal: Joi.object()\n      .keys({\n        contentDigest: Joi.string().required(),\n        mediaType: Joi.string(),\n        type: Joi.string().required(),\n        owner: Joi.string().required(),\n        fieldOwners: Joi.object(),\n        content: Joi.string().allow(``),\n        description: Joi.string(),\n        ignoreType: Joi.boolean(),\n        counter: Joi.number(),\n      })\n      .unknown(false), // Don't allow non-standard fields\n  })\n  .unknown()\n"],"file":"joi.js"}